<!doctype html>
<html lang="en" dir="ltr" class="docs-wrapper docs-doc-page docs-version-current plugin-docs plugin-id-default docs-doc-id-Planning/red-team-tradecraft">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.1">
<link rel="preconnect" href="https://www.google-analytics.com">
<script>window.ga=window.ga||function(){(ga.q=ga.q||[]).push(arguments)},ga.l=+new Date,ga("create","UA-156693847-1","auto"),ga("send","pageview")</script>
<script async src="https://www.google-analytics.com/analytics.js"></script>
<link rel="preconnect" href="https://www.google-analytics.com">
<link rel="preconnect" href="https://www.googletagmanager.com">
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-156693847-1"></script>
<script>function gtag(){dataLayer.push(arguments)}window.dataLayer=window.dataLayer||[],gtag("js",new Date),gtag("config","UA-156693847-1",{})</script>



<link rel="stylesheet" href="https://fonts.googleapis.com/icon?family=Material+Icons"><title data-rh="true">Red Team Tradecraft and TTP Guidance | Red Team Development and Operations</title><meta data-rh="true" property="og:url" content="https://redteam.guide/docs/Planning/red-team-tradecraft"><meta data-rh="true" name="docusaurus_locale" content="en"><meta data-rh="true" name="docsearch:language" content="en"><meta data-rh="true" name="twitter:card" content="summary"><meta data-rh="true" name="twitter:title" content="Red Team Development and Operations"><meta data-rh="true" name="twitter:description" content="A practical guide - by Joe Vest and James Tubberville"><meta data-rh="true" name="twitter:image" content="https://redteam.guide/img/books.png"><meta data-rh="true" name="docusaurus_version" content="current"><meta data-rh="true" name="docusaurus_tag" content="docs-default-current"><meta data-rh="true" name="docsearch:version" content="current"><meta data-rh="true" name="docsearch:docusaurus_tag" content="docs-default-current"><meta data-rh="true" property="og:title" content="Red Team Tradecraft and TTP Guidance | Red Team Development and Operations"><meta data-rh="true" name="description" content="Red Team Tradecraft and TTP Guidance
"><meta data-rh="true" property="og:description" content="Red Team Tradecraft and TTP Guidance
"><link data-rh="true" rel="icon" href="/img/favicon.ico"><link data-rh="true" rel="canonical" href="https://redteam.guide/docs/Planning/red-team-tradecraft"><link data-rh="true" rel="alternate" href="https://redteam.guide/docs/Planning/red-team-tradecraft" hreflang="en"><link data-rh="true" rel="alternate" href="https://redteam.guide/docs/Planning/red-team-tradecraft" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.e80e46c3.css">
<link rel="preload" href="/assets/js/runtime~main.70071a2e.js" as="script">
<link rel="preload" href="/assets/js/main.f10f8dac.js" as="script">
</head>
<body class="navigation-with-keyboard">
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div role="region"><a href="#" class="skipToContent_fXgn">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="REDTEAM.GUIDE" class="themedImage_ToTc themedImage--light_HNdA"><img src="/img/logo.png" alt="REDTEAM.GUIDE" class="themedImage_ToTc themedImage--dark_i4oU"></div><b class="navbar__title text--truncate">REDTEAM.GUIDE</b></a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/guides">Red Teaming Guides</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/about_the_book">About the book</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/about_the_authors">About the Authors</a><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/docs/definitions">Red Teaming Definitions</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/threatexpress" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link github"></a><a href="https://threatexpress.com" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">Blog<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a><div class="toggle_vylO colorModeToggle_DEke"><button class="clean-btn toggleButton_gllP toggleButtonDisabled_aARS" type="button" disabled="" title="Switch between dark and light mode (currently light mode)" aria-label="Switch between dark and light mode (currently light mode)"><svg viewBox="0 0 24 24" width="24" height="24" class="lightToggleIcon_pyhR"><path fill="currentColor" d="M12,9c1.65,0,3,1.35,3,3s-1.35,3-3,3s-3-1.35-3-3S10.35,9,12,9 M12,7c-2.76,0-5,2.24-5,5s2.24,5,5,5s5-2.24,5-5 S14.76,7,12,7L12,7z M2,13l2,0c0.55,0,1-0.45,1-1s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S1.45,13,2,13z M20,13l2,0c0.55,0,1-0.45,1-1 s-0.45-1-1-1l-2,0c-0.55,0-1,0.45-1,1S19.45,13,20,13z M11,2v2c0,0.55,0.45,1,1,1s1-0.45,1-1V2c0-0.55-0.45-1-1-1S11,1.45,11,2z M11,20v2c0,0.55,0.45,1,1,1s1-0.45,1-1v-2c0-0.55-0.45-1-1-1C11.45,19,11,19.45,11,20z M5.99,4.58c-0.39-0.39-1.03-0.39-1.41,0 c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0s0.39-1.03,0-1.41L5.99,4.58z M18.36,16.95 c-0.39-0.39-1.03-0.39-1.41,0c-0.39,0.39-0.39,1.03,0,1.41l1.06,1.06c0.39,0.39,1.03,0.39,1.41,0c0.39-0.39,0.39-1.03,0-1.41 L18.36,16.95z M19.42,5.99c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06c-0.39,0.39-0.39,1.03,0,1.41 s1.03,0.39,1.41,0L19.42,5.99z M7.05,18.36c0.39-0.39,0.39-1.03,0-1.41c-0.39-0.39-1.03-0.39-1.41,0l-1.06,1.06 c-0.39,0.39-0.39,1.03,0,1.41s1.03,0.39,1.41,0L7.05,18.36z"></path></svg><svg viewBox="0 0 24 24" width="24" height="24" class="darkToggleIcon_wfgR"><path fill="currentColor" d="M9.37,5.51C9.19,6.15,9.1,6.82,9.1,7.5c0,4.08,3.32,7.4,7.4,7.4c0.68,0,1.35-0.09,1.99-0.27C17.45,17.19,14.93,19,12,19 c-3.86,0-7-3.14-7-7C5,9.07,6.81,6.55,9.37,5.51z M12,3c-4.97,0-9,4.03-9,9s4.03,9,9,9s9-4.03,9-9c0-0.46-0.04-0.92-0.1-1.36 c-0.98,1.37-2.58,2.26-4.4,2.26c-2.98,0-5.4-2.42-5.4-5.4c0-1.81,0.89-3.42,2.26-4.4C12.92,3.04,12.46,3,12,3L12,3z"></path></svg></button></div><div class="searchBox_ZlJk"><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input search-bar"></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper mainWrapper_z2l0 docsWrapper_BCFX"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_sjWU" type="button"></button><div class="docPage__5DB"><aside class="theme-doc-sidebar-container docSidebarContainer_b6E3"><div class="sidebar_njMd"><nav class="menu thin-scrollbar menu_SIkG"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/about_the_authors">About the Authors</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/about_the_book">About the Book</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/definitions">Definitions</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/guides">Red Team Guides</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/references_templates_talks">References, Templates, and Presentations</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/checklists/red-team-checklist">Checklists and Planning</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/Concepts/mitre_attack">Concepts</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret menu__link--active" aria-expanded="true" href="/docs/Planning/goal-planning">Planning</a></div><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/Planning/goal-planning">Red Team Engagement Goal Planning</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/Planning/red-team-tradecraft">Red Team Tradecraft and TTP Guidance</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/Templates/oplog">Templates</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/Threat Profiles/autobank">Threat Profiles</a></div></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><div class="menu__list-item-collapsible"><a class="menu__link menu__link--sublist menu__link--sublist-caret" aria-expanded="false" href="/docs/Exercises/mindset-challege">Exercises</a></div></li></ul></nav></div></aside><main class="docMainContainer_gTbr"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_VOVn"><div class="docItemContainer_Djhp"><article><nav class="theme-doc-breadcrumbs breadcrumbsContainer_Z_bl" aria-label="Breadcrumbs"><ul class="breadcrumbs" itemscope="" itemtype="https://schema.org/BreadcrumbList"><li class="breadcrumbs__item"><a aria-label="Home page" class="breadcrumbs__link" href="/"><svg viewBox="0 0 24 24" class="breadcrumbHomeIcon_OVgt"><path d="M10 19v-5h4v5c0 .55.45 1 1 1h3c.55 0 1-.45 1-1v-7h1.7c.46 0 .68-.57.33-.87L12.67 3.6c-.38-.34-.96-.34-1.34 0l-8.36 7.53c-.34.3-.13.87.33.87H5v7c0 .55.45 1 1 1h3c.55 0 1-.45 1-1z" fill="currentColor"></path></svg></a></li><li class="breadcrumbs__item"><span class="breadcrumbs__link">Planning</span><meta itemprop="position" content="1"></li><li itemscope="" itemprop="itemListElement" itemtype="https://schema.org/ListItem" class="breadcrumbs__item breadcrumbs__item--active"><span class="breadcrumbs__link" itemprop="name">Red Team Tradecraft and TTP Guidance</span><meta itemprop="position" content="2"></li></ul></nav><div class="tocCollapsible_ETCw theme-doc-toc-mobile tocMobile_ITEo"><button type="button" class="clean-btn tocCollapsibleButton_TO0P">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Red Team Tradecraft and TTP Guidance</h1></header><div class="theme-admonition theme-admonition-info alert alert--info admonition_LlT9"><div class="admonitionHeading_tbUL"><span class="admonitionIcon_kALy"><svg viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>info</div><div class="admonitionContent_S0QG"><p>This template should be used to define the overall guidance on Red Team Tradecraft and TTPs. Every Red Team should have a guidance document. Keep this document updated and distributed to all Red Team members. This document should be used to guide Red Team actions of all Red Team operators on all engagements. Exceptions to these rules can (and will) be made based on specific Rules of Engagement (ROE) or decision made by Red Team leads during an engagement. Exceptions should be documented as part of the engagement logging. It is important to use and follow this document to maintain a high-quality professional Red Team.</p><p>Add custom or specific Tradecraft and TTP Guidance to this document as needed. This include specific or customs tools that should be used for various tasks, C2, enumeration, etc</p></div></div><h2 class="anchor anchorWithStickyNavbar_LWe7" id="guidance">Guidance<a class="hash-link" href="#guidance" title="Direct link to heading">​</a></h2><table><thead><tr><th>Do</th><th>Don&#x27;t</th></tr></thead><tbody><tr><td>Log all significant events</td><td>Use untested tools on a target system</td></tr><tr><td>Consult with peers</td><td>Use unencrypted channels for C2</td></tr><tr><td>Understand tools and technology used</td><td>Attempt to exploit or attack unencrypted websites</td></tr><tr><td>Perform situational awareness</td><td>Execute from non-executable locations</td></tr><tr><td>Minimize callback (C2) volume</td><td>Download restricted datasets</td></tr><tr><td></td><td>Use binaries for initial access</td></tr></tbody></table><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="do">DO<a class="hash-link" href="#do" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="log-all-significant-actions-successes-and-failures">LOG ALL SIGNIFICANT ACTIONS (SUCCESSES AND FAILURES)<a class="hash-link" href="#log-all-significant-actions-successes-and-failures" title="Direct link to heading">​</a></h3><p>Log, log and log some more! Screenshot all significant actions including successful and failed attempts. One of the most important aspects of the Red Team engagement is the collection of data (a.k.a. logs). It is common that an inexperienced team completes an engagement with subpar documentation. Many actions are not fully captured, some actions are never captured, and often key failures are ignored. Each action performed provides value to the target as well as the target defenders. Incomplete logs prevent the Red Team from providing a complete and accurate depiction of the actions, obstacles, and defensive strengths and weaknesses of the target (i.e. mission failure).
There are several methods to ensure logs are appropriately captured and stored:</p><ul><li>Automated logging of the terminal: All terminal actions logged, timestamped and stored to a predefined location.</li><li>Tool logs: Most commercial tools have some capability to log actions and produce a raw and/or final report.</li><li>Custom tools logs: If you write a custom tool/script, it should output a log of actions and results.</li><li>Operator logs: By far this is the most important log. A log may show the action performed and the result; however, only the operator can accurately note the way the action was performed, what lead them to the decision, and their interpretation of the result.</li><li>Screenshots: Terminal logs are great for the operator and even better as supporting artifacts; however, they may mean nothing to senior level executives (and even some IT professionals). Screenshots before, during, and following the execution of an action hold much more weight than a terminal log, tool log, or operator log (often if may just be a screenshot of the terminal during execution).</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="consult-with-peers">CONSULT WITH PEERS<a class="hash-link" href="#consult-with-peers" title="Direct link to heading">​</a></h3><p>No matter how long you have been performing IT or security, consult your peers before taking action. This is especially true during exploitation and command and control setup.
Simple mistakes often lead to Red Team discovery too early in the engagement.
Look at the command below. The command will be run as part of a tool written to provide general SA on a Linux system. What should the output look like?</p><div class="codeBlockContainer_Ckt0 theme-code-block" style="--prism-color:#ffffff;--prism-background-color:#033b3f"><div class="codeBlockContent_biex"><pre tabindex="0" class="prism-code language-text codeBlock_bY9V thin-scrollbar"><code class="codeBlockLines_e6Vv"><span class="token-line" style="color:#ffffff"><span class="token plain">netstat –antb</span><br></span></code></pre><div class="buttonGroup__atx"><button type="button" aria-label="Copy code to clipboard" title="Copy" class="clean-btn"><span class="copyButtonIcons_eSgA" aria-hidden="true"><svg class="copyButtonIcon_y97N" viewBox="0 0 24 24"><path d="M19,21H8V7H19M19,5H8A2,2 0 0,0 6,7V21A2,2 0 0,0 8,23H19A2,2 0 0,0 21,21V7A2,2 0 0,0 19,5M16,1H4A2,2 0 0,0 2,3V17H4V3H16V1Z"></path></svg><svg class="copyButtonSuccessIcon_LjdS" viewBox="0 0 24 24"><path d="M21,7L9,19L3.5,13.5L4.91,12.09L9,16.17L19.59,5.59L21,7Z"></path></svg></span></button></div></div></div><p>The command above is a netstat command that can be executed on a Windows host. Linux does not have the &quot;b&quot; option and produces an &quot;invalid option&quot; response.
Think about it</p><ul><li>Have you ever typed ifconfig instead of ipconfig? </li><li>Have you ever typed rm * in the wrong directory?</li><li>Have you ever entered credentials only to discover they were &quot;fat fingered&quot; (after access error)?
While these are oversimplifications, they represent the need for peer review on tools, C2, setup, execution, and even clean up.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="understand-the-tools-and-technologies-used">UNDERSTAND THE TOOLS AND TECHNOLOGIES USED<a class="hash-link" href="#understand-the-tools-and-technologies-used" title="Direct link to heading">​</a></h3><p>Understand the underlying technology of a tool or technique before using it on an event.
Know how the tool or technique interacts with a target, what network traffic it may generate, and what traces it may leave behind.
Knowing what a tool does is only one-third of the equation. What does that mean exactly? Let’s quickly look at a few questions and an example.</p><ul><li>What artifacts does the tool leave behind? - Are any files modified during execution?</li><li>Are there tales in the network traffic?</li></ul><p>Now let’s look at psexec (a commonly used tool, but not a recommended tool for Red Teaming a remote system)
Depending on how psexec is executed it:</p><ul><li>Copies a service file to the remote system</li><li>Enters a service key into the registry</li><li>Creates a prefetch file</li><li>Creates an entry in the Application Compatibility Cache - Creates a login event</li><li>Creates a profile folder for the remote user</li><li>Attempts to remove service file and key when exiting (not always successful)</li></ul><p>What happens when using the –e option? –s option? How does this differ from psexec for PowerShell?
Psexec is not a bad tool, and Red Team operators will use it. But... it is important to understand the IOCs generated by a tool. Getting caught due to a lack of tool understanding is not something any Red Team operators wants to experience.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="perform-situational-awareness">PERFORM SITUATIONAL AWARENESS<a class="hash-link" href="#perform-situational-awareness" title="Direct link to heading">​</a></h3><p>After gaining access to a remote system perform situational awareness before moving on.</p><ul><li>Understand the environment you are in (Is the target in scope?)</li><li>What protections exist on the system or network?</li><li>What are the risks of being caught and what attack paths does the system provide? - Are there pre-established connections to other network resources?</li><li>Who is into the system?</li><li>Who has recently logged into the system?</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="minimize-callback-c2-volume">MINIMIZE CALLBACK (C2) VOLUME<a class="hash-link" href="#minimize-callback-c2-volume" title="Direct link to heading">​</a></h3><p>Unless a Host Based protection mechanism is triggered, it is more likely to be discovered or
caught by a defenders recognition and/or analysis of traffic on the network. To avoid early detection, it is always good tradecraft to limit the amount of traffic generated during the engagement.
There are several general concepts that, if followed, increase the success of the engagement while decreasing the chances of being discovered:</p><ul><li>Keep traffic internal to a network: One of the most common issues, and one you should always attempt to change, are the limited number of sensors inside a network. Most network protections are currently applied at the boundary.</li><li>Pivot command and control traffic to a minimal number of outbound sources: Maintain at least two outbound sources for C2 redundancy; however, only use one for operations (considered an interactive tier). The second (a long or short haul tier) is dormant or extremely slow to be used as a backup if/when the primary is discovered.</li></ul><hr><h2 class="anchor anchorWithStickyNavbar_LWe7" id="dont">DON’T<a class="hash-link" href="#dont" title="Direct link to heading">​</a></h2><h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-untested-tools-on-a-target-system">USE UNTESTED TOOLS ON A TARGET SYSTEM<a class="hash-link" href="#use-untested-tools-on-a-target-system" title="Direct link to heading">​</a></h3><p>Before using a new tool (script, application, binary, process, etc.) on a target system, it must be tested, undergo an internal vetting process and be added to an official toolset.
Does the tool have negative impacts on specific versions of an OS?</p><ul><li>Works fine on Windows 7 but causes system error in Windows 8?</li><li>Do you know if/what additional actions the tool performs?</li><li>Tool creates a covert channel for use inside the network.</li><li>This tool creates a private tunnel between host on a virtual interface; however, this
creates a network conflict</li><li>Ex: target net: 10.10.2.0/24, covert channel net: 10.10.2.0/24 - Hint: Don’t use these!
Does the tool try to call home for updates?</li><li>At start or during a specific operation, the tool tries to poll home for updates</li><li>This can trigger defensive alerts identifying unauthorized persons or software on the network</li></ul><p>Does the tool attempt to run as a specific user or, worse, create a user/group? Keep these questions in mind before executing untested or unknown tools.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-unencrypted-channels-for-c2">USE UNENCRYPTED CHANNELS FOR C2<a class="hash-link" href="#use-unencrypted-channels-for-c2" title="Direct link to heading">​</a></h3><p>Command and control data exiting the network must be encrypted. Clear text data, such as
uploading a binary, issuing an operating system command or using a web shell will be detected by an IDS or other network defense if in clear text. It has become common for IPS/IDS to detect specific strings discovered in clear text traffic.
For example: &quot;C:\Windows\System32&quot; has become a common trigger for investigation.
Some defenders have even gone the extra mile in legitimizing a potential threat. Assume the defender uses a remote administration tool on a regular basis. Ignoring recommendation, this traffic is unencrypted. Rather than alert each time the tool is used legitimately, the alert is configured to look for inconsistencies in the text. For example: most attackers are accustomed to typing lowercase commands in windows. The defender ignores &quot;C:\Windows\System32&quot; but alerts on &quot;c:\windows\system32&quot;
Encryption of internal C2 traffic depends upon several different factors:</p><ul><li>Are there sensors inside the network?</li><li>Are there other encrypted communications occurring between target systems?</li><li>Would encrypted traffic stand-out more than unencrypted traffic?
Internal encryption is another example of where peers should be consulted to determine the best course of action before deploying C2 further into a network.</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="attempt-to-exploit-or-attack-unencrypted-websites">ATTEMPT TO EXPLOIT OR ATTACK UNENCRYPTED WEBSITES<a class="hash-link" href="#attempt-to-exploit-or-attack-unencrypted-websites" title="Direct link to heading">​</a></h3><p>As tempting as it may be, do not attack unencrypted websites. Simple attacks can trigger IDS. Always know your target IP space. There are likely several websites available for review. Proper reconnaissance and/or coordination should have discovered each. Create a list of sites in your target log. Include IP, URLs, an educated guess at the function, ports, protocols, etc.</p><p> Important Note!
Prior to performing any exploitation and attacks against a web server, refer to your rules of engagement and fully understand:</p><ul><li>Who actually owns the website?</li><li>Who owns the system where the website is hosted? Who owns the backend application?</li><li>Have proper approvals been obtained to test?</li></ul><h3 class="anchor anchorWithStickyNavbar_LWe7" id="execute-from-non-executable-locations">EXECUTE FROM NON-EXECUTABLE LOCATIONS<a class="hash-link" href="#execute-from-non-executable-locations" title="Direct link to heading">​</a></h3><p>Execution on a Windows environment must occur in a location typical of windows. Executable locations such as c:\programdata, c:\progam files, c:\windows\ are common. Execution for locations such as c:\windows\temp should never occur.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="use-binaries-for-initial-capabilities">USE BINARIES FOR INITIAL CAPABILITIES<a class="hash-link" href="#use-binaries-for-initial-capabilities" title="Direct link to heading">​</a></h3><p>As a general rule, do not drop binaries on the system. Use built-in commands, such as PowerShell, to achieve your goals first. This is not always possible and binaries may be required; however, binaries must be vetted, obfuscated and tested against detection before use.
Ensure all other &quot;Do’s and Don’ts&quot; are met for all binaries. Consult a senior operator before dropping any binary.</p><h3 class="anchor anchorWithStickyNavbar_LWe7" id="download-restricted-datasets">DOWNLOAD RESTRICTED DATASETS<a class="hash-link" href="#download-restricted-datasets" title="Direct link to heading">​</a></h3><p>NEVER download (or remove from the target network) any PII, HIPPA, PCI, or other restricted
datasets. A good rule of thumb is to annotate the type of data, location, access method, and level of access of restricted data in the log. Ensure the log notes include a reference to the type of data discovered for quick reference. Take a screenshot of the displayed filename and location (assuming the file name has no restricted data included). If the operator can screenshot a portion of the dataset without capturing the restricted data, they may do so for proof-of-access; however, DO NOT take screenshots of the data itself!</p></div></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><a class="pagination-nav__link pagination-nav__link--prev" href="/docs/Planning/goal-planning"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Red Team Engagement Goal Planning</div></a><a class="pagination-nav__link pagination-nav__link--next" href="/docs/Templates/oplog"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Operator Log</div></a></nav></div></div><div class="col col--3"><div class="tableOfContents_bqdL thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#guidance" class="table-of-contents__link toc-highlight">Guidance</a></li><li><a href="#do" class="table-of-contents__link toc-highlight">DO</a><ul><li><a href="#log-all-significant-actions-successes-and-failures" class="table-of-contents__link toc-highlight">LOG ALL SIGNIFICANT ACTIONS (SUCCESSES AND FAILURES)</a></li><li><a href="#consult-with-peers" class="table-of-contents__link toc-highlight">CONSULT WITH PEERS</a></li><li><a href="#understand-the-tools-and-technologies-used" class="table-of-contents__link toc-highlight">UNDERSTAND THE TOOLS AND TECHNOLOGIES USED</a></li><li><a href="#perform-situational-awareness" class="table-of-contents__link toc-highlight">PERFORM SITUATIONAL AWARENESS</a></li><li><a href="#minimize-callback-c2-volume" class="table-of-contents__link toc-highlight">MINIMIZE CALLBACK (C2) VOLUME</a></li></ul></li><li><a href="#dont" class="table-of-contents__link toc-highlight">DON’T</a><ul><li><a href="#use-untested-tools-on-a-target-system" class="table-of-contents__link toc-highlight">USE UNTESTED TOOLS ON A TARGET SYSTEM</a></li><li><a href="#use-unencrypted-channels-for-c2" class="table-of-contents__link toc-highlight">USE UNENCRYPTED CHANNELS FOR C2</a></li><li><a href="#attempt-to-exploit-or-attack-unencrypted-websites" class="table-of-contents__link toc-highlight">ATTEMPT TO EXPLOIT OR ATTACK UNENCRYPTED WEBSITES</a></li><li><a href="#execute-from-non-executable-locations" class="table-of-contents__link toc-highlight">EXECUTE FROM NON-EXECUTABLE LOCATIONS</a></li><li><a href="#use-binaries-for-initial-capabilities" class="table-of-contents__link toc-highlight">USE BINARIES FOR INITIAL CAPABILITIES</a></li><li><a href="#download-restricted-datasets" class="table-of-contents__link toc-highlight">DOWNLOAD RESTRICTED DATASETS</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container container-fluid"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Docs</div><ul class="footer__items clean-list"><li class="footer__item"><a class="footer__link-item" href="/docs/guides">Red Team Guides</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/about_the_book">About the Book</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/about_the_authors">About the Authors</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/definitions">Red Teaming Definitions</a></li></ul></div><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://twitter.com/joevest" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter - Joe Vest<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li><li class="footer__item"><a href="https://twitter.com/minis_io" target="_blank" rel="noopener noreferrer" class="footer__link-item">Twitter - James Tubberville<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div><div class="col footer__col"><div class="footer__title">More</div><ul class="footer__items clean-list"><li class="footer__item"><a href="https://threatexpress.com" target="_blank" rel="noopener noreferrer" class="footer__link-item">Blog</a></li><li class="footer__item"><a href="https://github.com/threatexpress" target="_blank" rel="noopener noreferrer" class="footer__link-item">GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_nPIU"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright © 2022 RedTeam.Guide</div></div></div></footer></div>
<script src="/assets/js/runtime~main.70071a2e.js"></script>
<script src="/assets/js/main.f10f8dac.js"></script>
</body>
</html>